Wayland
________________________________________________________________________________

Wayland [0] is a display protocol that aims to be a simpler replacement for the
X Window System. [1] Unlike Xorg, which provides a unified, featureful base for
the interchangeable window manager, the Wayland protocol as is, defines merely a
way for the GUI to talk to the underlying graphics interface.

This protocol has to be implemented in a library [2][3][4] first, which in
return provides the necessary Wayland extensions to create a compositor [5][6]
[7] upon. There is no unified way on how to implement Wayland, so the feature
set between compositors may vary, but they typically do the heavy lifting from
grabbing input events to allocating system resources and arrange all that for
the user in a usable GUI.


Caveats
________________________________________________________________________________

While the Wayland protocol is more or less done, the growing list of compositors
are in differing stages of completeness. Xorg is still in wide use and a lot of
software still requires it.

The major downside to Wayland (compositors) is the reduction in choice. While
the Wayland protocol does not define what a protocol shall depend on,
compositors typically lock the user into udev, libinput and systemd/logind.

The lack of standardized, desktop-oriented protocols has created a situation
where software may only work in some compositors and not others. This should
improve over time as more protocols become standardized.

- Limited hardware and driver support. [8] [9]
- Non-standard and compositor specific software. [10] [11] [12]
- No Wayland support in SDL 1.
- Games with non-free assets tend to not work with SDL2 and Wayland.
- Starting compositors without logind requires SUID permissions. [14]
- Locked into using udev. [15]

NOTE: This list of caveats will change over time.


Why would I use it then?
________________________________________________________________________________

While a system _can_ be simplified and improved utilization of given hardware
may result in better overall performance, only you can decide if the undeniable
bad is already weight out by the following goodies.

- less moving parts [13], although many graphical programs still heavily rely on
  Xorg libraries. (Mesa [16], Firefox [17], Qt-WebEngine [18], ...)
- Screen tearing is not possible by design.
- Hardware accelerated video playback in Firefox. (VAAPI)
- Hardware accelerated rendering in webkit2gtk. (WPEBackend-fdo)

NOTE: This list of goodies will change over time.


Prerequisites
________________________________________________________________________________

Though KISS does not support Wayland officially there is no problem in making it
capable through personal or 3rd party repositories. [19] The official
repositories satisfy all dependencies. After "wayland" and "wayland-protocols"
are installed, some package adjustments are required to make them to known
citizens of your system.

NOTE: From this point it is expected that "wayland" and "wayland-protocols" are
      installed and you have forked the required packages with modified
      configure flags at the beginning of KISS_PATH. [20] Managing repositories

* Packages which need to be forked [21]:

      firefox --enable-default-toolkit=cairo-gtk3-wayland
      gtk+3   --enable-wayland-backend
      mesa    -Dplatforms=x11,drm,wayland


* Packages which pick up Wayland automatically at compile time [22]:
  [needs expansion and verification]

      cairo
      intel-vaapi-driver
      libva
      mpv
      pango
      sdl2
      webkit2gtk


Install Wayland on top Xorg KISS
________________________________________________________________________________

Mesa must be rebuilt first, followed by the aforementioned packages [21][22] in
a dependency given ascending order.

NOTE: kiss-revdepends is the tool you need.

mesa, cairo, pango, gtk+3, firefox/webkit2gtk
      qt5-wayland
      mpv
      libva, intel-vaapi-driver
      sdl2

$ kiss b mesa && kiss i mesa && kiss b pango && kiss i pango ...


Install Wayland on top base KISS
________________________________________________________________________________

Starting off a fresh base installation there is no manual intervention needed as
everything _should_ be autoconfigured.
[needs reproduction]


Post installation
________________________________________________________________________________

* In environments without systemd/elogind/consolekit the XDG_RUNTIME_DIR
  variable must be set manually. [23] Export this in your shellrc.

  export XDG_RUNTIME_DIR=${XDG_RUNTIME_DIR:-/tmp/$(id -u)-runtime-dir}

  [ -d "$XDG_RUNTIME_DIR" ] || {
       mkdir -p   "$XDG_RUNTIME_DIR"
       chmod 0700 "$XDG_RUNTIME_DIR"
   }

* Install a Compositor of your choosing.


References
________________________________________________________________________________

[0]  https://wayland.freedesktop.org/
[1]  https://wayland.freedesktop.org/faq.html#heading_toc_j_4
[2]  $/swaywm/wlroots#wlroots
[3]  $/freedesktop/wayland-weston#libweston
[4]  $/michaelforney/swc#swc
[5]  $/swaywm/sway#sway
[6]  $/freedesktop/wayland-weston#weston
[7]  $/michaelforney/velox#velox
[8]  $/swaywm/sway/wiki#nvidia-users
[9]  https://wayland.freedesktop.org/building.html #Hardware / Drivers
[10] $/Alexays/Waybar
[11] $/any1/wayvnc
[12] $/fzwoch/obs-gnome-screencast
[14] $/swaywm/sway/wiki/Running-Sway-without-systemd
[15] $/swaywm/wlroots#building #udev
[16] $/kisslinux/repo/blob/master/extra/mesa/depends
[17] $/kisslinux/repo/blob/master/extra/firefox-bin/depends
[18] $/kisslinux/community/blob/master/community/qt5-webengine/depends
[19] User Wayland repsitory $/sdsddsd1/mywayland
[20] @/kiss/managing-repositories
[23] https://wiki.gentoo.org/wiki/Sway#Other
